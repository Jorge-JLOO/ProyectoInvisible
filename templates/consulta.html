{% extends "base.html" %}
{% block title %}Consulta de estudiante - Proyecto Educativo{% endblock %}

{% block content %}
<h2 class="mb-4"><i class="fa fa-search"></i> Consulta de Estudiante</h2>

<!-- Formulario de búsqueda -->
<form method="POST" class="mb-4">
  <div class="row g-2">
    <div class="col-md-6">
      <input type="text" name="documento" class="form-control" placeholder="Ingrese documento o cédula" required>
    </div>
    <div class="col-auto">
      <button type="submit" class="btn btn-primary">
        <i class="fa fa-search"></i> Consultar
      </button>
    </div>
  </div>
</form>

<!-- Resultados -->
{% if estudiante %}
  <div class="card shadow-sm">
    <div class="card-header bg-info text-white">
      <i class="fa fa-id-card"></i> Datos del estudiante
    </div>
    <div class="card-body">
      <p><b>Nombre:</b> {{ estudiante.nombre }}</p>
      <p><b>Documento:</b> {{ estudiante.documento }}</p>
      <p><b>Teléfono:</b> {{ estudiante.telefono or '-' }}</p>
      <p><b>Estado:</b>
        {% if estudiante.activo %}
          <span class="badge bg-success">Activo</span>
        {% else %}
          <span class="badge bg-danger">Inactivo</span>
        {% endif %}
      </p>
      <p><b>Último pago:</b> 
        {% if estudiante.pagos %}
          ${{ "%.2f"|format(estudiante.pagos[-1].valor) }} 
          - {{ estudiante.pagos[-1].fecha.strftime('%Y-%m-%d') }}
        {% else %}
          <span class="text-muted">Sin pagos registrados</span>
        {% endif %}
      </p>
    </div>
  </div>
{% elif request.method == 'POST' %}
  <div class="alert alert-warning">⚠️ No se encontró ningún estudiante con ese documento.</div>
{% endif %}
{% endblock %}